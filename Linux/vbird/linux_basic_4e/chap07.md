# 第七章 Linux 磁盘与文件系统管理

## 7.2 文件系统的简单操作

### 7.2.1 磁盘与目录的容量

- df：列出文件系统的整体磁盘使用量
- du：评估文件系统的磁盘使用量（常用在推算目录所占容量）

#### df

```cmd
df [-ahikHTm] [目录或文件名]
```

选项与参数

- -a 列出所有的文件系统，包括系统特有的 /proc 等文件系统；
- -m :以 MBytes 的容量显示各文件系统;
- -h :以人们较易阅读的 GBytes, MBytes, KBytes 等格式自行显示;
- -H :以 M=1000K 取代 M=1024K 的进位方式;
- -T :连同该 partition 的 filesystem 名称 (例如 xfs) 也列出;
- -i :不用磁盘容量，而以 inode 的数量来显示

#### du

```cmd
du [-ahskm] 文件或目录名称
```

- 仅显示目录容量（不含文件）

选项与参数

- -a :列出所有的文件与目录容量，因为默认仅统计目录下面的文件量而已。
- -h :以人们较易读的容量格式 (G/M) 显示;
- -s :列出总量而已，而不列出每个各别的目录占用容量;
- -S :不包括子目录下的总计，与 -s 有点差别。
- -k :以 KBytes 列出容量显示;
- -m :以 MBytes 列出容量显示;
 
### 7.2.2 实体链接与符号链接: ln

链接(link)

#### Hard Link (实体链接, 硬式链接或实际链接)

- 每个文件都会占用一个 inode ，文件内容由 inode 的记录来指向; 
- 想要读取该文件，必须要经过目录记录的文件名来指向到正确的 inode 号码才能读取。
- 其实文件名只与目录有关，但是文件内容则与 inode 有关
- **hard link**：有多个文件名对应到同一个 inode 号码
- **hard link** 只是在某个目录下新增一笔文件名链接到某 inode 号码的关连记录
- 一般来说，使用 hard link 设置链接文件时，磁盘的空间与 inode 的数目都不会改变!

**hard link 限制**

- 不能跨 Filesystem
- 不能 link 目录

#### Symbolic Link (符号链接，亦即是捷径)

```cmd
ln [-sf] 来源文件 目标文件
```

选项与参数:

- -s :如果不加任何参数就进行链接，那就是hard link，至于 -s 就是symbolic link
- -f :如果 目标文件 存在时，就主动的将目标文件直接移除后再创建!
 
## 7.3 磁盘的分区、格式化、检验与挂载

在系统里面新增一颗磁盘时，应该有哪些动作需要 做的呢:

1. 对磁盘进行分区，以创建可用的partition;
2. 对该partition进行格式化(format)，以创建系统可用的filesystem; 
3. 若想要仔细一点，则可对刚刚创建好的filesystem进行检验;
4. 在Linux系统上，需要创建挂载点(亦即是目录)，并将他挂载上来;

### 7.3.1 观察磁盘分区状态

#### lsblk 列出系统上的所有磁盘列表

- lsblk 可以看成“ list block device ”的缩写，就是列出所有储存设备的意思!

```cmd
lsblk [-dfimpt] [device]
```

选项与参数:
- -d :仅列出磁盘本身，并不会列出该磁盘的分区数据
- -f :同时列出该磁盘内的文件系统名称
- -i :使用 ASCII 的线段输出，不要使用复杂的编码 (再某些环境下很有用)
- -m :同时输出该设备在 /dev 下面的权限数据 (rwx 的数据)
- -p :列出该设备的完整文件名!而不是仅列出最后的名字而已。
- -t :列出该磁盘设备的详细数据，包括磁盘伫列机制、预读写的数据量大小等
 
#### parted 列出磁盘的分区表类型与分区信息