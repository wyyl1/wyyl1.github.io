---
title: "DDD-æ•°æ®åº“è®¾è®¡"
date: 2023-02-05T00:22:01+08:00
draft: false
tags: ["DDD","æå®¢æ—¶é—´"]
categories: ["å­¦ä¹ ç¬”è®°"]
---

> [DDD å­¦ä¹ ç¬”è®° | æå®¢æ—¶é—´ | æ‰‹æŠŠæ‰‹æ•™ä½ è½åœ° DDD](../dir)

[ğŸ† åŸæ–‡ï¼š08ï½œæ•°æ®åº“è®¾è®¡ï¼šæ€æ ·æŒ‰é¢†åŸŸæ¨¡å‹è®¾è®¡æ•°æ®åº“ï¼Ÿ](http://gk.link/a/11W17)

## è¯æ±‡è¡¨

| åˆ†ç±» | ä¸­æ–‡ | è‹±æ–‡ | è‹±æ–‡ç®€ç§°  |
|----|-----|------------|-----|
| é€šç”¨ | æ ‡è¯†ç¬¦ | identifier | id  |
| é€šç”¨ | ç»ç†  | manager | mng |
| é€šç”¨ | æˆå‘˜  | member | n/a |
| é€šç”¨ | è´Ÿè´£äºº    |   leader         | n/a |
| é€šç”¨ | è®°å½•    |  record          | n/a |
| é€šç”¨ | å¤‡æ³¨    |  notes          | n/a |
| é€šç”¨ | ç±»åˆ«    |  type          | n/a |
| é€šç”¨ | æ·»åŠ     |  add          | n/a |
| é€šç”¨ | ç­¾è®¢    |  sign          | n/a |
| é€šç”¨ | ä½¿ â€¦â€¦ ç”Ÿæ•ˆ    | enforce           | n/a |
| é€šç”¨ | ç»“æŸï¼ˆé¡¹ç›®ã€åˆåŒç­‰ï¼‰    |    close        | n/a |
| é€šç”¨ | åˆ›å»º/å»ºç«‹     |    create        | n/a |
| é€šç”¨ | å¯åŠ¨     |    start        | n/a |
| é€šç”¨ | åˆ†é…    |     assign       | n/a     |
| é€šç”¨ | æ›´æ¢    |     change       |  n/a    |
| é€šç”¨ | æ¯”ä¾‹    |     ratio       |  n/a    |
| ç§Ÿæˆ·ç®¡ç† | ç§Ÿæˆ·    | tenant           |    n/a  |
| ç»„ç»‡ç®¡ç†   | ç»„ç»‡ |  organization          | org |
| ç»„ç»‡ç®¡ç†   | ä¸Šçº§ | superior | n/a |
| ç»„ç»‡ç®¡ç†   | ä¸‹çº§ | subordinate | n/a |
| ç»„ç»‡ç®¡ç†   | å‘˜å·¥ | employee | emp |
| ç»„ç»‡ç®¡ç†   | å²—ä½ | post | n/a |
| ç»„ç»‡ç®¡ç†   | å‡ºç”Ÿæ—¥æœŸ | date of birth | dob |
| ç»„ç»‡ç®¡ç†   | å®¢æˆ· | client | n/a |
| ç»„ç»‡ç®¡ç†   | åˆåŒ | contract | n/a |
| ç»„ç»‡ç®¡ç†   | é¡¹ç›® | project | n/a |
| ç»„ç»‡ç®¡ç†   | æˆå‘˜ | member | n/a |
| ç»„ç»‡ç®¡ç†   | æŠ•å…¥ | invest | n/a |
| ç»„ç»‡ç®¡ç†   | é¢„è®¡/ä¼°è®¡ | estimate | n/a |
| ç»„ç»‡ç®¡ç†   | å·¥æ—¶ | effort | n/a |

## å®¡è®¡å­—æ®µ

| å­—æ®µ | ç±»å‹ | æ³¨é‡Š |
|----|-----|-----|
| created_at | datetime | åˆ›å»ºæ—¶é—´ |
| created_by | int | åˆ›å»ºäºº |
| last_updated_at | datetime |  æœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´ |
| last_updated_by | int |  æœ€åä¸€æ¬¡ä¿®æ”¹äºº |

## çº¦å®š

- æ‰€æœ‰çš„æ•°æ®è¡¨è®¾è®¡éƒ½é‡‡ç”¨è™šæ‹Ÿå¤–é”®
- é¢†åŸŸæ¨¡å‹ä¸­çš„å±æ€§ï¼Œä¸€èˆ¬ä¼šæ˜ å°„æˆè¡¨ä¸­çš„å­—æ®µ
- è™šçº¿ç®­å¤´è¡¨ç¤º**è™šæ‹Ÿå¤–é”®**ï¼›æˆ‘ä»¬æ‰€æœ‰çš„æ•°æ®è¡¨è®¾è®¡éƒ½é‡‡ç”¨è™šæ‹Ÿå¤–é”®
- æ•°æ®åº“ä¸­å…¶ä»–æ‰€æœ‰è¡¨éƒ½æœ‰ä¸€ä¸ªæŒ‡å‘ tenant è¡¨çš„è™šæ‹Ÿå¤–é”®ï¼Œä»¥ä¾¿åŒºåˆ†æ˜¯å“ªä¸ªç§Ÿæˆ·çš„æ•°æ®ã€‚å¦‚æœæ¯ä¸ªè™šæ‹Ÿå¤–é”®éƒ½ç”»å‡ºæ¥ï¼Œæˆ‘ä»¬çš„å›¾ä¼šå˜å¾—å¾ˆä¹±ï¼Œæ‰€ä»¥åé¢å°±åªåœ¨è¡¨ä¸­å†™å‡º tenant_idï¼Œä¸ç”»ç®­å¤´äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªæ³¨é‡Šè¯´æ˜è¿™ä»¶äº‹

## ç§Ÿæˆ·ç®¡ç†

![](../../../../../post/23/æ•°æ®åº“è®¾è®¡-ç§Ÿæˆ·ç®¡ç†.svg)

## ç»„ç»‡ç®¡ç†

![](../../../../../post/23/æ•°æ®åº“è®¾è®¡-ç»„ç»‡ç®¡ç†.svg)

## é¡¹ç›®ç®¡ç†

### emp:2 ï¼Œè€Œä¸”é™¤äº†ä¸»é”®ä»¥å¤–æ²¡æœ‰å…¶ä»–å±æ€§ï¼Ÿ

è¿™å…¶å®æ˜¯ä¸€ç§ç»˜å›¾æŠ€å·§ã€‚ä¸ºäº†é¿å…æ•´å¼ å›¾åƒèœ˜è››ç½‘ä¸€æ ·å‡Œä¹±ï¼Œæˆ‘ä»¬ä¸æ‰“ç®—æŠŠæ‰€æœ‰è¡¨éƒ½ç”»åœ¨åŒä¸€å¼ å›¾ä¸Šï¼Œè€Œæ˜¯æ¯ä¸ªæ¨¡å—ç”»ä¸€å¼ ã€‚
è€Œ **emp** è¡¨åœ¨**ç»„ç»‡ç®¡ç†**ä¸­å‡ºç°è¿‡ä¸€æ¬¡ï¼Œåœ¨**é¡¹ç›®ç®¡ç†**ä¸­åˆå‡ºç°äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨äº† **emp:2** è¯´æ˜è¿™æ˜¯ emp è¡¨çš„ç¬¬ â€œ2â€ æ¬¡å‡ºç°ã€‚

è‡³äºå±æ€§ï¼Œæˆ‘ä»¬åªåœ¨ emp è¡¨ç¬¬ä¸€æ¬¡å‡ºç°çš„æ—¶å€™è¯¦ç»†å†™å‡ºæ¥å°±å¯ä»¥äº†ï¼Œå…¶ä»–åœ°æ–¹ä¸å†™å±æ€§ï¼Œè¿™æ ·ï¼Œå½“éœ€è¦æ›´æ”¹å±æ€§çš„æ—¶å€™ï¼Œåªæ”¹ä¸€ä¸ªåœ°æ–¹å°±å¯ä»¥äº†ã€‚


![](../../../../../post/23/æ•°æ®åº“è®¾è®¡-é¡¹ç›®ç®¡ç†.svg)

**emp** è¡¨ä¸­çš„ numã€id_numã€nameã€genderã€dob åˆ†åˆ«è¡¨ç¤ºå‘˜å·¥å·ã€èº«ä»½è¯å·ã€å§“åã€æ€§åˆ«å’Œå‡ºç”Ÿæ—¥æœŸï¼ˆdate of birthï¼‰

## å·¥æ—¶ç®¡ç†

![](../../../../../post/23/æ•°æ®åº“è®¾è®¡-å·¥æ—¶ç®¡ç†.svg)

## MySQL å»ºè¡¨è¯­å¥


```sql
CREATE TABLE `client` (
  id int NOT NULL,
  tenant_id int NOT NULL,
  mng_id int DEFAULT NULL COMMENT 'ç»ç† id',
  `name` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL,
  create_at datetime NOT NULL,
  create_by int NOT NULL,
  last_updated_at datetime DEFAULT NULL,
  last_updated_by int DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin COMMENT='å®¢æˆ·';

CREATE TABLE contract (
  id int NOT NULL,
  tenant_id int NOT NULL,
  client_id int NOT NULL COMMENT 'å®¢æˆ· id',
  mng_id int DEFAULT NULL COMMENT 'ç»ç† id',
  `name` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL,
  `status` char(2) COLLATE utf8mb4_bin NOT NULL,
  create_at datetime NOT NULL,
  create_by int NOT NULL,
  last_updated_at datetime DEFAULT NULL,
  last_updated_by int DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin COMMENT='åˆåŒ';

CREATE TABLE effort_record (
  id int NOT NULL,
  tenant_id int NOT NULL,
  project_id int NOT NULL COMMENT 'é¡¹ç›® id',
  emp_id int NOT NULL,
  work_date date NOT NULL,
  effort decimal(2,1) NOT NULL COMMENT 'å·¥æ—¶',
  `name` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL,
  notes varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL COMMENT 'å¤‡æ³¨',
  create_at datetime NOT NULL,
  create_by int NOT NULL,
  last_updated_at datetime DEFAULT NULL,
  last_updated_by int DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin COMMENT='å·¥æ—¶è®°å½•';

CREATE TABLE emp (
  id int NOT NULL,
  tenant_id int NOT NULL,
  org_id int NOT NULL COMMENT 'ç»„ç»‡ id',
  num varchar(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL COMMENT 'å·¥å·',
  id_num varchar(20) COLLATE utf8mb4_bin NOT NULL COMMENT 'èº«ä»½è¯å·',
  `name` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL,
  gender char(2) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL COMMENT 'æ€§åˆ«',
  dob date DEFAULT NULL COMMENT 'å‡ºç”Ÿæ—¥æœŸ',
  create_at datetime NOT NULL,
  create_by int NOT NULL,
  last_updated_at datetime DEFAULT NULL,
  last_updated_by int DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin COMMENT='å‘˜å·¥';

CREATE TABLE emp_post (
  emp_id int NOT NULL,
  post_code char(10) COLLATE utf8mb4_bin NOT NULL,
  tenant_id int NOT NULL,
  `name` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL,
  create_at datetime NOT NULL,
  create_by int NOT NULL,
  last_updated_at datetime DEFAULT NULL,
  last_updated_by int DEFAULT NULL,
  PRIMARY KEY (emp_id,post_code) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin COMMENT='å‘˜å·¥å²—ä½';

CREATE TABLE org (
  id int NOT NULL,
  tenant_id int NOT NULL,
  superior_id int DEFAULT NULL COMMENT 'ä¸Šçº§ id',
  org_type_code char(10) COLLATE utf8mb4_bin NOT NULL COMMENT 'ç»„ç»‡ç±»åˆ«ä»£å·',
  leader_id int NOT NULL COMMENT 'è´Ÿè´£äºº id',
  `name` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL,
  create_at datetime NOT NULL,
  create_by int NOT NULL,
  last_updated_at datetime DEFAULT NULL,
  last_updated_by int DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin COMMENT='ç»„ç»‡';

CREATE TABLE org_type (
  `code` char(10) COLLATE utf8mb4_bin NOT NULL,
  tenant_id int NOT NULL,
  `name` varchar(50) COLLATE utf8mb4_bin NOT NULL,
  create_at datetime NOT NULL,
  create_by int NOT NULL,
  last_updated_at datetime DEFAULT NULL,
  last_updated_by int DEFAULT NULL,
  PRIMARY KEY (`code`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin COMMENT='ç»„ç»‡ç±»åˆ«';

CREATE TABLE post (
  `code` char(10) COLLATE utf8mb4_bin NOT NULL,
  tenant_id int NOT NULL,
  `name` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL,
  create_at datetime NOT NULL,
  create_by int NOT NULL,
  last_updated_at datetime DEFAULT NULL,
  last_updated_by int DEFAULT NULL,
  PRIMARY KEY (`code`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin COMMENT='å²—ä½';

CREATE TABLE project (
  id int NOT NULL,
  tenant_id int NOT NULL,
  contract_id int NOT NULL COMMENT 'åˆåŒ id',
  mng_id int DEFAULT NULL COMMENT 'ç»ç† id',
  num varchar(50) COLLATE utf8mb4_bin NOT NULL,
  `name` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL,
  `status` char(2) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL,
  create_at datetime NOT NULL,
  create_by int NOT NULL,
  last_updated_at datetime DEFAULT NULL,
  last_updated_by int DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin COMMENT='é¡¹ç›®';

CREATE TABLE project_member (
  id int NOT NULL,
  tenant_id int NOT NULL,
  project_id int NOT NULL COMMENT 'é¡¹ç›® id',
  emp_id int NOT NULL,
  estimate_invest_ratio smallint NOT NULL COMMENT 'é¢„è®¡æŠ•å…¥æ¯”ä¾‹',
  start_at date NOT NULL,
  end_at date DEFAULT NULL,
  `name` varchar(50) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL,
  `status` char(2) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL,
  create_at datetime NOT NULL,
  create_by int NOT NULL,
  last_updated_at datetime DEFAULT NULL,
  last_updated_by int DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin COMMENT='é¡¹ç›®æˆå‘˜';

CREATE TABLE tenant (
  id int NOT NULL,
  `name` varchar(50) COLLATE utf8mb4_bin NOT NULL,
  create_at datetime NOT NULL,
  create_by int NOT NULL,
  last_updated_at datetime DEFAULT NULL,
  last_updated_by int DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin COMMENT='ç§Ÿæˆ·';

```